---
# ---------------------------------------------------------------------------
# START: modbus include file for HA-FoxESS-Modbus LAN connection
# ---------------------------------------------------------------------------
# Supports RS485 connection to KH series using RS-485 to LAN/Wifi adapter.
- name: FoxESSInverterModbus

  # ---------------------------Direct LAN Connection-------------------------
  # Connection details. Enter your IP address in secrets.yaml
  type: tcp
  host: !secret foxess_inv1_ip_address
  port: 502
  delay: 1
  # -------------------------------------------------------------------------

  # list of modbus addresses to read
  sensors:
    - name: "Inverter Model"
      unique_id: foxess_inv1_inverter_model
      scan_interval: !secret scan_interval_static
      address: 30000
      count: 7
      data_type: string
      input_type: input
    - name: "Serial Number"
      unique_id: foxess_inv1_serial_number
      scan_interval: !secret scan_interval_static
      address: 30008
      count: 7
      data_type: string
      input_type: input
    - name: "Master Version"
      unique_id: foxess_inv1_master_version
      address: 30016
      scan_interval: !secret scan_interval_static
      input_type: input
      data_type: int16
      scale: 0.01
      precision: 2
    - name: "Slave Version"
      unique_id: foxess_inv1_slave_version
      address: 30017
      scan_interval: !secret scan_interval_static
      input_type: input
      data_type: int16
      scale: 0.01
      precision: 2
    - name: "Manager Version"
      unique_id: foxess_inv1_manager_version
      address: 30018
      scan_interval: !secret scan_interval_static
      input_type: input
      data_type: int16
      scale: 0.01
      precision: 2

    - name: "PV1 Voltage"
      unique_id: foxess_inv1_pv1_voltage
      scan_interval: !secret scan_interval_medium
      address: 31000
      state_class: measurement
      unit_of_measurement: "V"
      data_type: int16
      scale: 0.1
      precision: 1
      input_type: holding
      device_class: voltage
    - name: "PV1 Current"
      unique_id: foxess_inv1_pv1_current
      scan_interval: !secret scan_interval_medium
      address: 31001
      state_class: measurement
      unit_of_measurement: "A"
      data_type: int16
      scale: 0.1
      precision: 1
      input_type: holding
      device_class: current
    - name: "PV1 Power"
      unique_id: foxess_inv1_pv1_power
      scan_interval: !secret scan_interval_high
      address: 31002
      state_class: measurement
      unit_of_measurement: "kW"
      data_type: int16
      scale: 0.001
      precision: 3
      input_type: holding
      device_class: power
    - name: "PV2 Voltage"
      unique_id: foxess_inv1_pv2_voltage
      scan_interval: !secret scan_interval_medium
      address: 31003
      state_class: measurement
      unit_of_measurement: "V"
      data_type: int16
      scale: 0.1
      precision: 1
      input_type: holding
      device_class: voltage
    - name: "PV2 Current"
      unique_id: foxess_inv1_pv2_current
      scan_interval: !secret scan_interval_medium
      address: 31004
      state_class: measurement
      unit_of_measurement: "A"
      data_type: int16
      scale: 0.1
      precision: 1
      input_type: holding
      device_class: current
    - name: "PV2 Power"
      unique_id: foxess_inv1_pv2_power
      scan_interval: !secret scan_interval_high
      address: 31005
      state_class: measurement
      unit_of_measurement: "kW"
      data_type: int16
      scale: 0.001
      precision: 3
      input_type: holding
      device_class: power

    - name: "RVolt"
      unique_id: foxess_inv1_grid_voltage_R
      scan_interval: !secret scan_interval_medium
      address: 31006
      state_class: measurement
      unit_of_measurement: "V"
      data_type: int16
      precision: 2
      scale: 0.1
      input_type: holding
      device_class: voltage
    - name: "RCurrent"
      unique_id: foxess_inv1_inv_current_R
      scan_interval: !secret scan_interval_medium
      address: 31007
      state_class: measurement
      unit_of_measurement: "A"
      data_type: int16
      scale: 0.1
      precision: 1
      input_type: holding
      device_class: current
    - name: "RPower"
      unique_id: foxess_inv1_inv_power_R
      scan_interval: !secret scan_interval_high
      address: 31008
      state_class: measurement
      unit_of_measurement: "kW"
      data_type: int16
      scale: 0.001
      precision: 3
      input_type: holding
      device_class: power
    - name: "RFreq"
      unique_id: foxess_inv1_grid_frequency
      scan_interval: !secret scan_interval_low
      address: 31009
      state_class: measurement
      unit_of_measurement: "Hz"
      data_type: int16
      scale: 0.01
      precision: 3
      input_type: holding
      device_class: frequency

    - name: "EPS RVolt"
      unique_id: foxess_inv1_eps_rvolt
      scan_interval: !secret scan_interval_medium
      address: 31010
      state_class: measurement
      unit_of_measurement: "V"
      data_type: int16
      precision: 2
      scale: 0.1
      input_type: holding
      device_class: voltage
    - name: "EPS RCurrent"
      unique_id: foxess_inv1_eps_rcurrent
      scan_interval: !secret scan_interval_medium
      address: 31011
      state_class: measurement
      unit_of_measurement: "A"
      data_type: int16
      scale: 0.1
      precision: 1
      input_type: holding
      device_class: current
    - name: "EPS RPower"
      unique_id: foxess_inv1_eps_rpower
      scan_interval: !secret scan_interval_high
      address: 31012
      state_class: measurement
      unit_of_measurement: "kW"
      data_type: int16
      scale: 0.001
      precision: 3
      input_type: holding
      device_class: power
    - name: "EPS RFreq"
      unique_id: foxess_inv1_eps_frequency
      scan_interval: !secret scan_interval_low
      address: 31013
      state_class: measurement
      unit_of_measurement: "Hz"
      data_type: int16
      scale: 0.01
      precision: 3
      input_type: holding
      device_class: frequency

    - name: "Grid CT"
      unique_id: foxess_inv1_grid_ct
      scan_interval: !secret scan_interval_high
      address: 31014
      state_class: measurement
      unit_of_measurement: "kW"
      data_type: int16
      scale: 0.001
      precision: 3
      input_type: holding
      device_class: power
    - name: "CT2"
      unique_id: foxess_inv1_ct2
      scan_interval: !secret scan_interval_high
      address: 31015
      state_class: measurement
      unit_of_measurement: "kW"
      data_type: int16
      scale: 0.001
      precision: 3
      input_type: holding
      device_class: power
    - name: "Load Power"
      unique_id: foxess_inv1_load_power
      scan_interval: !secret scan_interval_high
      address: 31016
      state_class: measurement
      unit_of_measurement: "kW"
      data_type: int16
      scale: 0.001
      precision: 3
      input_type: holding
      device_class: power

    - name: "InvTemp"
      unique_id: foxess_inv1_inverter_temperature
      scan_interval: !secret scan_interval_low
      address: 31018
      state_class: measurement
      unit_of_measurement: "°C"
      data_type: int16
      scale: 0.1
      precision: 1
      device_class: temperature
      input_type: holding
    - name: "AmbTemp"
      unique_id: foxess_inv1_ambient_temperature
      scan_interval: !secret scan_interval_low
      address: 31019
      state_class: measurement
      unit_of_measurement: "°C"
      data_type: int16
      scale: 0.1
      precision: 1
      device_class: temperature
      input_type: holding
    - name: "InvBatVolt"
      unique_id: foxess_inv1_inverter_battery_voltage
      scan_interval: !secret scan_interval_medium
      address: 31020
      state_class: measurement
      unit_of_measurement: "V"
      data_type: int16
      scale: 0.1
      precision: 1
      device_class: voltage
      input_type: holding
    - name: "InvBatCurrent"
      unique_id: foxess_inv1_inverter_battery_current
      scan_interval: !secret scan_interval_medium
      address: 31021
      state_class: measurement
      unit_of_measurement: "A"
      data_type: int16
      scale: 0.1
      precision: 1
      input_type: holding
      device_class: current
    - name: "InvBatPower"
      unique_id: foxess_inv1_battery_power
      scan_interval: !secret scan_interval_high
      address: 31022
      state_class: measurement
      unit_of_measurement: "kW"
      data_type: int16
      scale: 0.001
      precision: 3
      input_type: holding
      device_class: power
    - name: "Battery Temp"
      unique_id: foxess_inv1_battery_temperature
      scan_interval: !secret scan_interval_low
      address: 31023
      state_class: measurement
      unit_of_measurement: "°C"
      scale: 0.1
      precision: 1
      data_type: int16
      input_type: holding
      device_class: temperature
    - name: "Battery SoC"
      unique_id: foxess_inv1_battery_soc
      scan_interval: !secret scan_interval_low
      address: 31024
      state_class: measurement
      unit_of_measurement: "%"
      data_type: int16
      input_type: holding
      device_class: battery

    - name: "Solar Energy Total"
      unique_id: foxess_inv1_solar_energy_total
      address: 32000
      scan_interval: !secret scan_interval_low
      input_type: input
      data_type: uint32
      scale: 0.1
      precision: 1
      device_class: energy
      state_class: total_increasing
      unit_of_measurement: "kWh"
    - name: "Solar Energy Today"
      unique_id: foxess_inv1_solar_energy_today
      address: 32002
      scan_interval: !secret scan_interval_low
      input_type: input
      data_type: uint16
      scale: 0.1
      precision: 1
      device_class: energy
      state_class: total
      unit_of_measurement: "kWh"
    - name: "Battery Charge Total"
      unique_id: foxess_inv1_battery_charge_total
      address: 32003
      scan_interval: !secret scan_interval_low
      input_type: input
      data_type: uint32
      scale: 0.1
      precision: 1
      device_class: energy
      state_class: total_increasing
      unit_of_measurement: "kWh"
    - name: "Battery Charge Today"
      unique_id: foxess_inv1_battery_charge_today
      address: 32005
      scan_interval: !secret scan_interval_low
      input_type: input
      data_type: uint16
      scale: 0.1
      precision: 1
      device_class: energy
      state_class: total
      unit_of_measurement: "kWh"
    - name: "Battery Discharge Total"
      unique_id: foxess_inv1_battery_discharge_total
      address: 32006
      scan_interval: !secret scan_interval_low
      input_type: input
      data_type: uint32
      scale: 0.1
      precision: 1
      device_class: energy
      state_class: total_increasing
      unit_of_measurement: "kWh"
    - name: "Battery Discharge Today"
      unique_id: foxess_inv1_battery_discharge_today
      address: 32008
      scan_interval: !secret scan_interval_low
      input_type: input
      data_type: uint16
      scale: 0.1
      precision: 1
      device_class: energy
      state_class: total
      unit_of_measurement: "kWh"
    - name: "Feed In Energy Total"
      unique_id: foxess_inv1_feed_in_energy_total
      address: 32009
      scan_interval: !secret scan_interval_low
      input_type: input
      data_type: uint32
      scale: 0.1
      precision: 1
      device_class: energy
      state_class: total_increasing
      unit_of_measurement: "kWh"
    - name: "Feed In Energy Today"
      unique_id: foxess_inv1_feed_in_energy_today
      address: 32011
      scan_interval: !secret scan_interval_low
      input_type: input
      data_type: uint16
      scale: 0.1
      precision: 1
      device_class: energy
      state_class: total
      unit_of_measurement: "kWh"
    - name: "Grid Consumption Energy Total"
      unique_id: foxess_inv1_grid_consumption_energy_total
      address: 32012
      scan_interval: !secret scan_interval_low
      input_type: input
      data_type: uint32
      scale: 0.1
      precision: 1
      device_class: energy
      state_class: total_increasing
      unit_of_measurement: "kWh"
    - name: "Grid Consumption Energy Today"
      unique_id: foxess_inv1_grid_consumption_energy_today
      address: 32014
      scan_interval: !secret scan_interval_low
      input_type: input
      data_type: uint16
      scale: 0.1
      precision: 1
      device_class: energy
      state_class: total
      unit_of_measurement: "kWh"
    - name: "Total Yield Total"
      unique_id: foxess_inv1_total_yield_total
      address: 32015
      scan_interval: !secret scan_interval_low
      input_type: input
      data_type: uint32
      scale: 0.1
      precision: 1
      device_class: energy
      state_class: total_increasing
      unit_of_measurement: "kWh"
    - name: "Total Yield Today"
      unique_id: foxess_inv1_total_yield_today
      address: 32017
      scan_interval: !secret scan_interval_low
      input_type: input
      data_type: uint16
      scale: 0.1
      precision: 1
      device_class: energy
      state_class: total
      unit_of_measurement: "kWh"
    - name: "Input Energy Total"
      unique_id: foxess_inv1_input_energy_total
      address: 32018
      scan_interval: !secret scan_interval_low
      input_type: input
      data_type: uint32
      scale: 0.1
      precision: 1
      device_class: energy
      state_class: total_increasing
      unit_of_measurement: "kWh"
    - name: "Input Energy Today"
      unique_id: foxess_inv1_input_energy_today
      address: 32020
      scan_interval: !secret scan_interval_low
      input_type: input
      data_type: uint16
      scale: 0.1
      precision: 1
      device_class: energy
      state_class: total
      unit_of_measurement: "kWh"
    - name: "Load Energy Total"
      unique_id: foxess_inv1_load_energy_total
      address: 32021
      scan_interval: !secret scan_interval_low
      input_type: input
      data_type: uint32
      scale: 0.1
      precision: 1
      device_class: energy
      state_class: total_increasing
      unit_of_measurement: "kWh"
    - name: "Load Energy Today"
      unique_id: foxess_inv1_load_energy_today
      address: 32023
      scan_interval: !secret scan_interval_low
      input_type: input
      data_type: uint16
      scale: 0.1
      precision: 1
      device_class: energy
      state_class: total
      unit_of_measurement: "kWh"

  # ---------------------------------------------------------------------------
  # END: modbus include file for HA-FoxESS-Modbus LAN connection
  # ---------------------------------------------------------------------------
